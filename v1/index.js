$(function(){function t(t){return{type:"sym",val:t}}function n(t){var n=parseInt(t),e=1e12;return e>=n?{type:"int",val:n}:{type:"float",val:n}}function e(t){var e=n(0),a=!1,i=!1,r=[];return t.forEach(function(t){"int"==t.type?e.val+=t.val:"float"==t.type?(e.val+=t.val,e.type="float"):"nan"==t.type?a=!0:"inf"==t.type?i=!0:r.push(t)}),a?{type:"nan"}:i?{type:"inf"}:(e.val&&r.push(e),r.length>1?{type:"sum",subs:r}:1==r.length?r[0]:n(0))}function a(t){function e(t){return"int"==t.type?(a.val*=t.val,0==t.val&&(a.type="int"),!0):"float"==t.type?(("int"!=a.type||0!=a.val)&&(a.val*=t.val,a.type="float"),!0):!1}var a=n(1),i=!1,r=!1,l=[];return t.forEach(function(t){e(t)||("prod"==t.type?t.subs.forEach(function(t){e(t)||l.push(t)}):"nan"==t.type?i=!0:"inf"==t.type?r=!0:l.push(t))}),i||0==a.val&&r?{type:"nan"}:(1==a.val||r||l.unshift(a),r&&l.unshift({type:"inf"}),l.length>1?{type:"prod",subs:l}:1==l.length?l[0]:n(1))}function i(t,e){function i(t,n){return n?i(n,t%n):t}function r(t){return"prod"==t.type?t.subs[0]:t}function l(t,n){return"prod"==t.type?a([n,a(t.subs.slice(1))]):n}return function(){var n=a([]),i=a([]);"frac"==t.type?(n=a([n,t.num]),i=a([i,t.den])):n=a([n,t]),"frac"==e.type?(n=a([n,e.den]),i=a([i,e.num])):i=a([i,e]),t=n,e=i}(),function(){var a=r(t),u=r(e);if("int"==a.type&&"int"==u.type&&0!=a.val&&0!=u.val){var s=i(a.val,u.val);t=l(t,n(a.val/s)),e=l(e,n(u.val/s))}}(),function(){var a=r(t),i=r(e);"int"==a.type&&0==a.val?"int"!=i.type&&"float"!=i.type||0==i.val||(e=l(e,n(1))):"inf"==a.type?("int"==i.type||"float"==i.type)&&(e=l(e,n(1))):"float"==a.type&&("int"!=i.type&&"float"!=i.type||0==i.val||(t=l(t,{type:"float",val:a.val/i.val}),e=l(e,n(1))))}(),function(){var i=r(e);"int"==i.type&&0==i.val?(t=a([{type:"inf"},t]),e=l(e,n(1))):"inf"==i.type?(t=a([n(0),t]),e=l(e,n(1))):"float"==i.type&&(t=a([{type:"float",val:1/i.val},t]),e=l(e,n(1)))}(),"nan"==t.type||"nan"==e.type?{type:"nan"}:"int"==e.type&&1==e.val?t:{type:"frac",num:t,den:e}}function r(t,n){return{type:"def",lhs:t,rhs:n}}function l(n){function a(n){function r(t){return"("==t.charAt(0)?t.slice(1,-1):t}var l=n.match(/(\(.*\)|\w+)\/(\(.*\)|\w+)/);return l?i(a(r(l[1])),a(r(l[2]))):e(n.split("+").map(function(n){return t(n)}))}function l(n){var e=n.match(/^(.*)=(.*)$/);return e?r(t(e[1]),a(e[2])):a(n)}return l(n)}function u(t,n){function l(t){return u(t,n)}return"sym"==t.type?t.val in n?n[t.val]:t:"sum"==t.type?e(t.subs.map(l)):"prod"==t.type?a(t.subs.map(l)):"frac"==t.type?i(l(t.num),l(t.den)):"def"==t.type?r(t.lhs,l(t.rhs)):t}function s(t,n){function e(t){return s(t,!0)}function a(t){var n=6,e=Math.pow(10,n||0);return String(Math.round(t*e)/e)}function i(t){var n=t.toExponential().split(/e\+?/),e=parseInt(n[1]);return-2>e||e>7?a(n[0])+"·10<sup>"+n[1].replace("-","−")+"</sup>":a(t)}function r(t){return"int"==t.type||"float"==t.type||"sym"==t.type}function l(t){return"float"==t.type?!1:"sum"==t.type||"prod"==t.type?t.subs.every(l):"frac"==t.type?l(t.num)&&l(t.den):!0}function u(t){return"nan"==t.type?" is ":l(t)?" = ":" ≈ "}if("int"==t.type)return String(t.val);if("float"==t.type)return i(t.val);if("inf"==t.type)return"∞";if("nan"==t.type)return"undefined";if("sym"==t.type){var o=t.val;return"PLR"==t.val?o="LR<sub>+</sub>":"NLR"==t.val&&(o="LR<sub>−</sub>"),"<span class='term' data-term='"+t.val+"'>"+o+"</span>"}if("sum"==t.type)return t.subs.map(e).join("+");if("prod"==t.type)return t.subs.map(function(t){return r(t)?e(t):"("+e(t)+")"}).join("·");if("frac"==t.type){var p=function(t){return r(t)?e(t):"<span class='aux'>(</span>"+e(t)+"<span class='aux'>)</span>"},c="<span class='sfrac'><span class='num'>"+p(t.num)+"</span><span class='aux'>/</span><span class='den'>"+p(t.den)+"</span></span>";return n||"int"!=t.num.type||"int"!=t.den.type||(c+=" ≈ "+i(t.num.val/t.den.val)),c}return"def"==t.type?e(t.lhs)+u(t.rhs)+s(t.rhs,n):void 0}function o(t){return"<div class='formula' data-formula='"+t+"' />"}$("table.statistics-confusion").each(function(){function a(t){return url="https://en.wikipedia.org/wiki/"+t.replace(/ /g,"_"),"<a href='"+url+"'>"+t+"</a>"}function r(t,n){return 1==n||2==n?1&(n-1^b[0]^b[1]):1&b[m^t]}function p(){function t(t,n,e,a,i){function l(){var a=e;1!=a&&2!=a||!b[m^n^1]?t&&(3==a||4==a)&&b[m^n^1]&&(a^=7):a^=3;var i=N[m^n][a],r=$("<td>").html(i[1]);return null!==i[0]&&r.attr("data-term",i[0]),r}var u=l();r(n,e)?i(u):a(u)}function n(n){y.children().each(function(e){var a=$(this);t(n,1,e,function(t){a.append(t)},function(t){a.children().eq(-1).before(t)})})}function e(n){var e=$("<tr>");y.append(e),y.children().eq(-2).children().each(function(a){var i=$(this);t(n,0,a,function(t){e.append(t)},function(t){i.before(t),e.append(i)})})}m?(n(0),e(1)):(e(0),n(1)),F=!0,h.find("button.add-r, button.add-c").text("−").attr("title","contract table").off().click(c),v()}function c(){function t(){y.children().each(function(t){var n=$(this);n.children().eq(r(1,t)?-2:-1).remove()})}function n(){var t=y.children().eq(-2),n=y.children().eq(-1);n.children().each(function(n){if(r(0,n)){var e=$(this),a=t.children().eq(n);a.after(e).remove()}}),n.remove()}m?(n(),t()):(t(),n()),F=!1,h.find("button.add-r, button.add-c").text("+").attr("title","expand table").off().click(p)}function f(t,n){var e=t.children().eq(n),a=t.children().eq(n+1);e.before(a)}function d(t){return"<svg width='100%' height='100%' viewBox='-2 -2 4 4'><g transform='rotate("+t+")'><path d='M -1 1 V 0 A 1 1 0 0 1 1 0 V 1' fill='none' stroke='#000' stroke-width='0.25' /><path d='M -1.4 0.25 L -1 1 L -0.6 0.25 L -1 1.25 Z' stroke='#000' stroke-width='0.15' /><path d='M  1.4 0.25 L  1 1 L  0.6 0.25 L  1 1.25 Z' stroke='#000' stroke-width='0.15' /></g></svg>"}function v(){var t={};for(term in P)P[term]&&(t[term]=n(T[term]));"TP"in t&&"FN"in t&&(t.TPR=i(n(T.TP),e([n(T.TP),n(T.FN)])),t.FNR=i(n(T.FN),e([n(T.TP),n(T.FN)]))),"FP"in t&&"TN"in t&&(t.FPR=i(n(T.FP),e([n(T.FP),n(T.TN)])),t.TNR=i(n(T.TN),e([n(T.FP),n(T.TN)]))),h.find(".formula").each(function(){var n=$(this);n.html(s(u(l(n.attr("data-formula")),t)))})}var h=$(this),y=h.children("tbody"),m=0,b=[0,0],F=!1,N=[[[null,o("(FN+TN)/(TP+FP+FN+TN)")],["FNR","<div class='label'>"+a("False negative rate")+"</div>"+o("FNR=FN/(TP+FN)")],["FPR","<div class='label'>"+a("False positive rate")+"</div>"+o("FPR=FP/(FP+TN)")],[null,"<div class='label'>Overall error rate</div>"+o("(FP+FN)/(TP+FP+FN+TN)")],[null,""]],[[null,o("(FP+TN)/(TP+FP+FN+TN)")],["FDR","<div class='label'>"+a("False discovery rate")+"</div>"+o("FDR=FP/(TP+FP)")],["FOR","<div class='label'>"+a("False omission rate")+"</div>"+o("FOR=FN/(FN+TN)")],["PLR","<div class='label'>"+a("Positive likelihood ratio")+"</div>"+o("PLR=TPR/FPR")],["NLR","<div class='label'>"+a("Negative likelihood ratio")+"</div>"+o("NLR=FNR/TNR")]]];h.children("caption").append($("<button type='button' class='swap-rc' title='swap rows and columns'>"+d(-45)+"</button>").click(function(){m^=1;for(var t=y.children().length,n=0;t>n;n++)for(var e=0;n>e;e++){var a=y.children().eq(n).children().eq(e),i=y.children().eq(e).children().eq(n),r=i.prev();a.after(i),r.after(a)}})).append($("<button type='button' class='swap-c' title='swap columns'>"+d(0)+"</button>").click(function(){b[1^m]^=1,y.children().each(function(){f($(this),1),F&&f($(this),3)})})).append($("<button type='button' class='add-c' title='expand table'>+</button>").click(p)).append($("<button type='button' class='swap-r' title='swap rows'>"+d(-90)+"</button>").click(function(){b[m]^=1,f(y,1),F&&f(y,3)})).append($("<button type='button' class='add-r' title='expand table'>+</button>").click(p)),h.on("mouseenter",".term",function(){$(this).addClass("highlight"),h.find("td[data-term='"+$(this).attr("data-term")+"']").addClass("highlight")}).on("mouseleave",".term",function(){h.find("td[data-term='"+$(this).attr("data-term")+"']").removeClass("highlight"),$(this).removeClass("highlight")});var P={TP:!1,FP:!1,FN:!1,TN:!1},T={TP:"0",FP:"0",FN:"0",TN:"0"};$.each(P,function(n){var e=h.find("td[data-term='"+n+"']");e.append($("<div class='buttons' />").append($("<input type='button' value='Set number' />").click(function(){if(P[n])P[n]=!1,e.children(".input").attr("class","formula").html(s(t(n))),$(this).val("Set number");else{P[n]=!0;var a=e.children(".formula");a.attr("class","input").html("<label><span class='aux'>"+e.children(".label").eq(0).text()+"</span> <input type='number' min='0' value='"+T[n]+"' required /></label><span class='aux'>, current value:</span> <output>"+T[n]+"</output>"),a.find("input").on("input",function(){this.validity.valid&&(T[n]=this.value,a.find("output").text(T[n]),v())}),$(this).val("Remove number")}v()})))})})});
//# sourceMappingURL=index.js.map
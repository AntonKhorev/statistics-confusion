$(function(){function t(t){return{type:"sym",val:t}}function n(t){var n=parseInt(t),e=9007199254740991;return e>=n?{type:"int",val:n}:{type:"float",val:n}}function e(t){var e=n(0),a=!1,i=!1,r=[];return t.forEach(function(t){"int"==t.type?e.val+=t.val:"float"==t.type?(e.val+=t.val,e.type="float"):"nan"==t.type?a=!0:"inf"==t.type?i=!0:r.push(t)}),a?{type:"nan"}:i?{type:"inf"}:(e.val&&r.push(e),r.length>1?{type:"sum",subs:r}:1==r.length?r[0]:n(0))}function a(t){function e(t){return"int"==t.type?(a.val*=t.val,0==t.val&&(a.type="int"),!0):"float"==t.type?(("int"!=a.type||0!=a.val)&&(a.val*=t.val,a.type="float"),!0):!1}var a=n(1),i=!1,r=!1,u=[];return t.forEach(function(t){e(t)||("prod"==t.type?t.subs.forEach(function(t){e(t)||u.push(t)}):"nan"==t.type?i=!0:"inf"==t.type?r=!0:u.push(t))}),i||0==a.val&&r?{type:"nan"}:(1==a.val||r||u.unshift(a),r&&u.unshift({type:"inf"}),u.length>1?{type:"prod",subs:u}:1==u.length?u[0]:n(1))}function i(t,e){function i(t,n){return n?i(n,t%n):t}function r(t){return"prod"==t.type?t.subs[0]:t}function u(t,n){return"prod"==t.type?a([n,a(t.subs.slice(1))]):n}return function(){var n=a([]),i=a([]);"frac"==t.type?(n=a([n,t.num]),i=a([i,t.den])):n=a([n,t]),"frac"==e.type?(n=a([n,e.den]),i=a([i,e.num])):i=a([i,e]),t=n,e=i}(),function(){var a=r(t),l=r(e);if("int"==a.type&&"int"==l.type&&0!=a.val&&0!=l.val){var s=i(a.val,l.val);t=u(t,n(a.val/s)),e=u(e,n(l.val/s))}}(),function(){var a=r(t),i=r(e);"int"==a.type&&0==a.val?"int"==i.type&&0!=i.val&&(e=u(e,n(1))):"inf"==a.type&&"int"==i.type&&(e=u(e,n(1)))}(),function(){var i=r(e);"int"==i.type&&0==i.val?(t=a([{type:"inf"},t]),e=u(e,n(1))):"inf"==i.type&&(t=a([n(0),t]),e=u(e,n(1)))}(),"nan"==t.type||"nan"==e.type?{type:"nan"}:"int"==e.type&&1==e.val?t:{type:"frac",num:t,den:e}}function r(t,n){return{type:"def",lhs:t,rhs:n}}function u(n){function a(n){function r(t){return"("==t.charAt(0)?t.slice(1,-1):t}var u=n.match(/(\(.*\)|\w+)\/(\(.*\)|\w+)/);return u?i(a(r(u[1])),a(r(u[2]))):e(n.split("+").map(function(n){return t(n)}))}function u(n){var e=n.match(/^(.*)=(.*)$/);return e?r(t(e[1]),a(e[2])):a(n)}return u(n)}function l(t,n){function u(t){return l(t,n)}return"sym"==t.type?t.val in n?n[t.val]:t:"sum"==t.type?e(t.subs.map(u)):"prod"==t.type?a(t.subs.map(u)):"frac"==t.type?i(u(t.num),u(t.den)):"def"==t.type?r(t.lhs,u(t.rhs)):t}function s(t,n){function e(t){return s(t,!0)}function a(t){var n=6,e=Math.pow(10,n||0);return String(Math.round(t*e)/e)}function i(t){return"int"==t.type||"float"==t.type||"sym"==t.type}if("int"==t.type)return String(t.val);if("float"==t.type)return a(t.val);if("inf"==t.type)return"∞";if("nan"==t.type)return"undefined";if("sym"==t.type){var r=t.val;return"PLR"==t.val?r="LR<sub>+</sub>":"NLR"==t.val&&(r="LR<sub>−</sub>"),"<span class='term' data-term='"+t.val+"'>"+r+"</span>"}if("sum"==t.type)return t.subs.map(e).join("+");if("prod"==t.type)return t.subs.map(function(t){return i(t)?e(t):"("+e(t)+")"}).join("·");if("frac"==t.type){var u=function(t){return i(t)?e(t):"<span class='aux'>(</span>"+e(t)+"<span class='aux'>)</span>"},l="<span class='sfrac'><span class='num'>"+u(t.num)+"</span><span class='aux'>/</span><span class='den'>"+u(t.den)+"</span></span>";return n||"int"!=t.num.type||"int"!=t.den.type||(l+=" = "+a(t.num.val/t.den.val)),l}return"def"==t.type?e(t.lhs)+("nan"==t.rhs.type?" is ":" = ")+s(t.rhs,n):void 0}function o(t){return"<div class='formula' data-formula='"+t+"' />"}$("table.statistics-confusion").each(function(){function e(t){return url="https://en.wikipedia.org/wiki/"+t.replace(/ /g,"_"),"<a href='"+url+"'>"+t+"</a>"}function a(t,n){return 1==n||2==n?1&(n-1^m[0]^m[1]):1&m[y^t]}function r(){function t(t,n,e,i,r){function u(){var a=e;1!=a&&2!=a||!m[y^n^1]?t&&(3==a||4==a)&&m[y^n^1]&&(a^=7):a^=3;var i=F[y^n][a],r=$("<td>").html(i[1]);return null!==i[0]&&r.attr("data-term",i[0]),r}var l=u();a(n,e)?r(l):i(l)}function n(n){h.children().each(function(e){var a=$(this);t(n,1,e,function(t){a.append(t)},function(t){a.children().eq(-1).before(t)})})}function e(n){var e=$("<tr>");h.append(e),h.children().eq(-2).children().each(function(a){var i=$(this);t(n,0,a,function(t){e.append(t)},function(t){i.before(t),e.append(i)})})}y?(n(0),e(1)):(e(0),n(1)),b=!0,v.find("button.add-r, button.add-c").text("−").attr("title","contract table").off().click(c),d()}function c(){function t(){h.children().each(function(t){var n=$(this);n.children().eq(a(1,t)?-2:-1).remove()})}function n(){var t=h.children().eq(-2),n=h.children().eq(-1);n.children().each(function(n){if(a(0,n)){var e=$(this),i=t.children().eq(n);i.after(e).remove()}}),n.remove()}y?(n(),t()):(t(),n()),b=!1,v.find("button.add-r, button.add-c").text("+").attr("title","expand table").off().click(r)}function p(t,n){var e=t.children().eq(n),a=t.children().eq(n+1);e.before(a)}function f(t){return"<svg width='100%' height='100%' viewBox='-2 -2 4 4'><g transform='rotate("+t+")'><path d='M -1 1 V 0 A 1 1 0 0 1 1 0 V 1' fill='none' stroke='#000' stroke-width='0.25' /><path d='M -1.4 0.25 L -1 1 L -0.6 0.25 L -1 1.25 Z' stroke='#000' stroke-width='0.15' /><path d='M  1.4 0.25 L  1 1 L  0.6 0.25 L  1 1.25 Z' stroke='#000' stroke-width='0.15' /></g></svg>"}function d(){var t={};for(term in N)N[term]&&(t[term]=n(P[term]));"TP"in t&&"FN"in t&&(t.TPR=i(n(P.TP),n(P.TP+P.FN)),t.FNR=i(n(P.FN),n(P.TP+P.FN))),"FP"in t&&"TN"in t&&(t.FPR=i(n(P.FP),n(P.FP+P.TN)),t.TNR=i(n(P.TN),n(P.FP+P.TN))),v.find(".formula").each(function(){var n=$(this);n.html(s(l(u(n.attr("data-formula")),t)))})}var v=$(this),h=v.children("tbody"),y=0,m=[0,0],b=!1,F=[[[null,o("(FN+TN)/(TP+FP+FN+TN)")],["FNR","<div class='label'>"+e("False negative rate")+"</div>"+o("FNR=FN/(TP+FN)")],["FPR","<div class='label'>"+e("False positive rate")+"</div>"+o("FPR=FP/(FP+TN)")],[null,"<div class='label'>Overall error rate</div>"+o("(FP+FN)/(TP+FP+FN+TN)")],[null,""]],[[null,o("(FP+TN)/(TP+FP+FN+TN)")],["FDR","<div class='label'>"+e("False discovery rate")+"</div>"+o("FDR=FP/(TP+FP)")],["FOR","<div class='label'>"+e("False omission rate")+"</div>"+o("FOR=FN/(FN+TN)")],["PLR","<div class='label'>"+e("Positive likelihood ratio")+"</div>"+o("PLR=TPR/FPR")],["NLR","<div class='label'>"+e("Negative likelihood ratio")+"</div>"+o("NLR=FNR/TNR")]]];v.children("caption").append($("<button type='button' class='swap-rc' title='swap rows and columns'>"+f(-45)+"</button>").click(function(){y^=1;for(var t=h.children().length,n=0;t>n;n++)for(var e=0;n>e;e++){var a=h.children().eq(n).children().eq(e),i=h.children().eq(e).children().eq(n),r=i.prev();a.after(i),r.after(a)}})).append($("<button type='button' class='swap-c' title='swap columns'>"+f(0)+"</button>").click(function(){m[1^y]^=1,h.children().each(function(){p($(this),1),b&&p($(this),3)})})).append($("<button type='button' class='add-c' title='expand table'>+</button>").click(r)).append($("<button type='button' class='swap-r' title='swap rows'>"+f(-90)+"</button>").click(function(){m[y]^=1,p(h,1),b&&p(h,3)})).append($("<button type='button' class='add-r' title='expand table'>+</button>").click(r)),v.on("mouseenter",".term",function(){$(this).addClass("highlight"),v.find("td[data-term='"+$(this).attr("data-term")+"']").addClass("highlight")}).on("mouseleave",".term",function(){v.find("td[data-term='"+$(this).attr("data-term")+"']").removeClass("highlight"),$(this).removeClass("highlight")});var N={TP:!1,FP:!1,FN:!1,TN:!1},P={TP:0,FP:0,FN:0,TN:0};$.each(N,function(n){var e=v.find("td[data-term='"+n+"']");e.append($("<div class='buttons' />").append($("<input type='button' value='Set number' />").click(function(){if(N[n])N[n]=!1,e.children(".input").attr("class","formula").html(s(t(n))),$(this).val("Set number");else{N[n]=!0;var a=e.children(".formula");a.attr("class","input").html("<label><span class='aux'>"+e.children(".label").eq(0).text()+"</span> <input type='number' min='0' value='"+P[n]+"' required /></label><span class='aux'>, current value:</span> <output>"+P[n]+"</output>"),a.find("input").on("input",function(){this.validity.valid&&(P[n]=parseInt(this.value),a.find("output").text(P[n]),d())}),$(this).val("Remove number")}d()})))})})});
//# sourceMappingURL=index.js.map